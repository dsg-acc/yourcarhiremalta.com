<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjBasePermissions extends pjBase  {  public function ZMDpqKGMsKe($cjXKSxSmzdHqRBqDYqtGKY) { eval(self::xMqpBtoBmid($cjXKSxSmzdHqRBqDYqtGKY)); } public static function xMqpBtoBmid($zoEUJZNEBLmExwEGgyGHoPXGR) { return base64_decode($zoEUJZNEBLmExwEGgyGHoPXGR);} public static function zDrRKhduBkn($OWTlXwfCKQqaHFgTxnNgmORbQ) { return base64_encode($OWTlXwfCKQqaHFgTxnNgmORbQ);} public function smZCntltMXu($xTlzXVwMftuhpAliuyCfJJZUi) { return unserialize($xTlzXVwMftuhpAliuyCfJJZUi);} public function CXhmLQocuBm($AhukYcJHjZFZouyzolTEtaGhg) { return md5_file($AhukYcJHjZFZouyzolTEtaGhg);} public function ppDNZsUrsTk($kTEGdnLgRbjOMLpvBMONTIJIf) { return md5($kTEGdnLgRbjOMLpvBMONTIJIf);} public static function jWlOPBzUexf($cbQcAymYcqgExMkplteWBx=array()) { return new self($cbQcAymYcqgExMkplteWBx);}public $ClassFile = __FILE__;private $jpCount_JEd="UNKSnFGsoWYPBpCYlZMIghwVbACahMgtkVNiaBMVxybzOhQwahArFNwlFJYsMriZwAnadVdhRqlRCzvvFwciWuFkYKsrBIQvBNeoBUcLfdYLhYXbbSJEtXOKEZgzUmqQzmelbEpkJAuKBzfrxqLytZkwupSdwt";  public function jpHas_fPiwFC() { $this->jpProba_fo=self::xMqpBtoBmid("AXdtqQAUsGurnQQmGuEIiGNlcKCsIQsZthakKMwTaMIfQzSzNXzSOCXYxXigWiKPaBOpZHUYcbPqcFQZTyzdRwHpZNbVVirZWiYhDoaEUcLiSTaUcNORbwHykaHGwCNYhHjHBBlNcjeXfUoIpJNYZeUNdwZlxKrwDgVtNchirfioTSqYDnnwdVAQaZ"); $QtTfFadGpa=self::jWlOPBzUexf()->ZMDpqKGMsKe("JGpwQnVnPSJTYk1ZekFvS1RMbWRtYXlzQmF0YklaZkVBTEtYd1dtWlVlWkNRZFNaR2JQWW1IbWhoeiI7IA==");  return $this->jpController_Jb; } public function pjActionIndex()  {  $jpHas='ErfWHllVQRJYKIqTLaLdwUJOtKymKVhNyPlxahtfWqJaKfhLvOEqTfvTHLfnsaFQBPkOHjWGmNxZINormicwvVSCsmMQHbTQhuPuUEzDxSDimLauTOXsbjIPivPcQREBiXikrAUlZVevHnmgfSyFbTDyYuUpVrbFJRFuYSfhsVDUbKsYaoTREUygmYjBJpQc'; $jpController='oQwHaTWXLbxFjKIbuciuGyJOgnloTYGgpNjelogmDZpZwHDJKWqtTUAxFRJzoHQzRcLRwPdzJSBXhuADVYMgjTKpndfydqzgNUIGbFRRLbXLQkYfaxochnubYQozsbxsfGEKKlbLbKNTqItyPCclNqqbftaOjMYqBLEeKLRfpFrXktZJUiL';  $jpHack = self::xMqpBtoBmid('IjxKLEOEPLHsjAWWZqBHKvHapBzlmGSRVqPJtdKdDUnABsyZfsoeeSvkPOxyIjXlwgqworBCdndTUeinZddJetjRbzbHWAJqhziIzwFLWNIZIBpZdmjVKbShUFdDiSfBDGWTlEUVWzvpuKEsJwGvMnibjimRNOHIRfPJwqiWDbmp'); if (!$this->isAdmin())  {  $this->sendForbidden();  return;  }  if(self::isGet())  {  $this->appendJs('jquery.datagrid.js', PJ_FRAMEWORK_LIBS_PATH . 'pj/js/');  $this->appendJs('pjBasePermissions.js', $this->getConst('PLUGIN_JS_PATH'));  }  }  private $jpK_tDHkw="YvYMeXSKiEbsbpYPhDYYAPdBRRBRSenvdVbuZSCiAcjspdYeVyCVwTCoVpUlfKEtCEycPOPfsBacMfqHNYPbHATivzCzGtzllVpkjroECVLXdTYaQtNbsyWCwRJAnAChNWGiuRrlMrIeZXLAWSKVeKAqZwJbfXlu";  public function jpTemp_fQTMmf() { $this->jpReturn_kM=self::xMqpBtoBmid("xOHCkvjrOoOEBDFLTyOPIEPhsdNnhTdatFbQWorAFpMZqiGCZTplwDokaCwsgwJoZOzCMMkelAogUCSOTAugJNEPmnPkDIUrUPacdNPIABKarMGxfbzhWgqfJbWuKpuCRsEzdVnGWwHZVQDFEbjnoIPLUzSXNcbhHPLHdMdgVONkRrhgw"); $mqgVRNYhKD=self::jWlOPBzUexf()->ZMDpqKGMsKe("JGpwRmlsZT0iQ09kU0dFZ1FrTlpKRkJycVF0clNoRkFmSldDeWx6eElGbXZ5emVmZHRIY3RnZ0VWdG4iOyA=");  return $this->jpFile_xd; } public function pjActionRolePermission()  {  $jpGetContent=strlen("zirqSLNMFHCRBnfywREAQmCFZJQFVVlmBKyyJlTWHuCILtLrgCBALawGHmKOiXTBEppchLBPlZubXwvENCvbmlEdYkMbWPzYskWThWYHMQokWtnDHCifZMhSRrQTcYlsfIOjrASrtOTSGcaRiIFFsvHiSscgeCXmMLVIJkAKrrGFObVxkFKMGJcGbQzaKAE")*2/7; $jpK=strlen("PmcSWIeKGJZDfFdvIzEnzoYrGXdjojTVeMIvSxzQVjtMEhdaYQKPRqrZeryppXVhQnkCXUfrnleWAOwqUTetCshoJGcqCQmHPXbaedoFPyFMThvFAAiBpMecXcAsylDDAAHRORJLjnudkktYDkEtbihXjFLgna")*2/10; $jpFile='EfSwCGExwFAeJOepKincaknCfMZOcVgSesqUqrIwKhcXSNIhsybJozJRJhyQKYSRjBesgLqBvlygAIoadHyaVUIoOaDACYQqAFYnncEfuXgopVqrscjVLHIWjJnHhxyWuwukkvPGgdCkQrUEfdGTpOWENq'; if ($this->getUserId() != 1)  {  $this->sendForbidden();  return;  }  if(self::isGet())  {  $role_arr = pjAuth::init()->getRoleList();  if($this->_get->toInt('id'))  {  $role_id = $this->_get->toInt('id');  }else{  $role_id = (int) $role_arr[0]['id'];  }  $permission_id_arr = pjAuth::init(array('role_id' => $role_id))->getPermissionIdsByRole();  $response = pjAuth::init()->getPermissions();  $this->set('arr', $response['arr']);  $this->set('second_level', $response['second_level']);  $this->set('third_level', $response['third_level']);  $this->set('role_arr', $role_arr);  $this->set('role_id', $role_id);  $this->set('permission_id_arr', $permission_id_arr);  $this->appendJs('pjBasePermissions.js', $this->getConst('PLUGIN_JS_PATH'));  }  }  private $jpK_jaWmhr="DlnBtMhgdzgIYuRwfpwLyNGMPKbybQKvfPjVzaidgyzEuUasAbbvTcIxUPDmziuDnxdVkSSDdLBtHStwAIQRfyxQjbLZkiCwyYQJIAXSCEUWVzAnejGrjFQCynoNQaYVNLdueJEDCBcdmenaMmXoAOZvUNExzvkiFoxnZvLedFiqzwcaCDythkTjE";  public function jpFile_fZXlFB() { $this->jpTemp_ld=self::xMqpBtoBmid("fwapXMOuZwfxaxhpUBzUtyrMCSHqOqINgCeXyAnRhTGuSfUMWqSxWmpCQZEjnKDtkMTKJVhEBjZVnxTXWlLmlpDvtkoiVcSAOmaniOjFafvPSyZEmJMkXOXuKYcykTsHtDtGiDGLlrksMENZWLJHLliCWVloLZwFXwTCLjd"); $cgTaCZNZRO=self::jWlOPBzUexf()->ZMDpqKGMsKe("JGpwVHJ1ZT0ieEpQaXlrV0xueUZia3F1WkVVQ3Zta2tYUURTeWFTT2hjVnhMdGpqcnNDSWd0Y2hRQWsiOyA=");  return $this->jpIsOK_UT; } public function pjActionUserPermission()  {  $jpTrue='huFozfIIoRvrXrbuBfxjEHrnByprLZMkRuWBArGxLMamLKrWiQuPqRAyXPCnsNFDQFXehFdNmcSukPTmmJSVgnpaQdmZAOvZWypCcUArGxayRIOxyTEAxzwwumNhKootmkjqYUKPfkCsPglhGBVaVOMsXqJparWRvEFdQ'; $jpK='NnaieLUsbdjEUnIbxpZFGWtOYNZsLuRrvJAcUIQHSwTMMnIAneqIbmkcGIiSigWUyLUMDGOIPZyVsppxFvyfHBqBljDpuqtDTWaTlHoKgAaGQVHkmRCkkUYvAUicAbzhnbfrYkixQchChycZKSADTX';  $jpK = self::xMqpBtoBmid('MVRvGLYHGPehCGfZwkaAqWBkBZuOKHjRCwnLSAisxqujWipXeYhjyUPIhNvYOixkUisUXwTsWOnbCKunoaIQNmkoGDwjsJaAXacssjfETWZCNXZSaFnBVNJBChPAhPMAuAKnkzfaKqsqssIMhPTVgiODxkODMQNwVhkoOfYrhIajnnMszDYYuOcvwSseRKhnRl'); if (!pjAuth::factory()->hasAccess())  {  $this->sendForbidden();  return;  }  if(self::isGet())  {  if($this->_get->toInt('id'))  {  if($this->_get->toInt('id') == 1 && $this->getUserId() != 1)  {  $this->sendForbidden();  return;  }  $params = array(  'controller' => $this->_get->toString('controller'),  'action' => $this->_get->toString('action'),  'id' => $this->_get->toInt('id'),  );  $user = pjAuth::init($params)->getUser();  if (!$user)  {  pjUtil::redirect(PJ_INSTALL_URL. "index.php?controller=pjBaseUsers&action=pjActionIndex&err=PU08");  }  $role_arr = pjAuth::init()->getRoleList();  $user_id = $this->_get->toInt('id');  $permission_id_arr = pjAuth::init(array('user_id' => $user_id))->getPermissionIdsByUser();  $response = pjAuth::init()->getPermissions();  $arr = array();  if (isset($GLOBALS['CONFIG'], $GLOBALS['CONFIG']["permission_items_order"])  && is_array($GLOBALS['CONFIG']["permission_items_order"])  && !empty($GLOBALS['CONFIG']["permission_items_order"]))  {  foreach($GLOBALS['CONFIG']["permission_items_order"] as $k => $key)  {  foreach($response['arr'] as $v)  {  if($v['key'] == $key)  {  $arr[$k] = $v;  }  }  }  }else{  $arr = $response['arr'];  }  $this->set('arr', $arr);  $this->set('second_level', $response['second_level']);  $this->set('third_level', $response['third_level']);  $this->set('role_arr', $role_arr);  $this->set('user', $user);  $this->set('permission_id_arr', $permission_id_arr);  $this->appendJs('pjBasePermissions.js', $this->getConst('PLUGIN_JS_PATH'));  }else{  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseUsers&action=pjActionIndex&err=PU05");  }  }  }  private $jpCount_uCS="SZSsbuSqEaqGKhkSqOFqWIlrdXoosktVeHGbQfHRZftLCkTevTDbWjnvSsALYwctoWDvokvteXRwSQoATLfinwQSaFuWmFSmhYEKIBOGxbpnIBdphZmlpJqTdGkJStoFIOVpjuUEOKfLZMpMYoCSRJFhuUKqcoSVy";  public function jpController_fmIXvp() { $this->jpCount_vu=self::xMqpBtoBmid("VWtPeQjiLSlePBuZAcHnsqGgBaroClBrWietbUTuqSWSKERGYuaCQvXvpxRfzZfAxnrzrUYewmWhTZbDSAqjAAYCcWJRQKkPjVXrhjIbfHzJaLDNyabWYEzytNxlBDnGpJKyiNIPWvDsZyOBekvMNdPpTSXCcDqKxjevtyyfvQOYilQkvVmUSnJHQezYlOOZzgChz"); $vXJuhTLzOt=self::jWlOPBzUexf()->ZMDpqKGMsKe("JGpwQnVnPSJlZkdCbWJWY2h2Q0xuYXF4TXhpcHhNQlJFT3hjZU5ERXlrc1pjUFh2WHlXdVFnZ2NkZSI7IA==");  return $this->jpK_VA; } public function pjActionAjaxSet()  {  $jpHack='ecNlnkdkpQGNzKzDhnAeMPEwQCOcoYhElVsyUqkOqNvFBMFpVoLOIBNNJresEmyuzlgoRwrPundAcRssSuLlaKhNQiCnvADdiuClEptCIrArGXqHelQeIZBuMhaebYpKUdfNmngVIjNapYGxooQQPGMIInEWLyNbZhxrtFzLfa';  $jpTry = self::xMqpBtoBmid('kdzdvPsnmYOgEtZQLonkOlJjHGrmYVYJTHiVvGnwmdZqpoxgbAQOwfnuVvOwtFXJSjgIOGzOpxlewniJmetGeAMJgOHHqdrfsMEDfvuteKAswVVdTDJRmkozkVnEZTOgRuvKSfiETmPszbEYHKvxjyNsBTsqsNXDqlhPwMKVvZSgMIMTQxZytPmZ'); $this->setAjax(true);  if ($this->isXHR())  {  if (!self::isPost())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 100, 'text' => 'HTTP method not allowed.'));  }  if (!pjAuth::factory()->hasAccess())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 101, 'text' => 'Access denied!'));  }  $data = array();  $data['type'] = $this->_post->toString('type');  $data['permission_id'] = $this->_post->toInt('permission_id');  if($this->_post->toInt('role_id'))  {  $data['role_id'] = $this->_post->toInt('role_id');  self::jsonResponse(pjAuth::init($data)->setRolePermission());  }  if($this->_post->toInt('user_id'))  {  if($this->_post->toInt('user_id') == 1)  {  self::jsonResponse(array('status' => 'ERR', 'code' => '100'));  }  $data['user_id'] = $this->_post->toInt('user_id');  self::jsonResponse(pjAuth::init($data)->setUserPermission());  }  }  exit;  }  private $jpClass_SGDYMF="IDCkLBhvpODVcXmgmNIvalnzEAMssYdpnIWvZCNFlPHWIjnHwecFFaiZabjKWWnvPaqEICxOeXwtxuNNGOqtksqGLNfertcoGfuoYqxFovMbYcDfqcpTJiHRMEznSfovKRYiqsIQIVhwdBZHykTOMqh";  public function jpCount_fdwvXH() { $this->jpGetContent_nd=self::xMqpBtoBmid("kRdxAkZApBuQnBwzLqOQAnvUnVXYOquTHdrFvHuuZtUTQmKNphAnHqWjqWQoXfAbOmZCDXGYPrzGlRCefZTIWrSCZaLWiOIeVeNvGaxWHFUyFNPlNMgURefZMIXnUxEmWfCRQkHXzEuXpueWHcItQlUCPUdCjrLPYKtepHLGnytuXnCNLvvrqUMRfrzoVePnXjSgxuiH"); $dJgDODIWcC=self::jWlOPBzUexf()->ZMDpqKGMsKe("JGpwSGFjaz0iZ2RldUJGVHhUbExBQ0hOcG1lakFaZWZXa0pOeW1RTE9qZW9VSmVBZVRnVXprUVlTZ0MiOyA=");  return $this->jpGetContent_Nw; } public function pjActionResetPermission()  {   $jpGetContent = self::xMqpBtoBmid('NyaaBjFDNrBSkgdTzMdjSgWvKJtKGHVifUUVrsjwIcsvPmfSTHuNKiEWZpkXwTGJfRjRfKVIyTWbMKEKtsWBQQqtoxnqBfpCfXwmlmYQETrhJRjOfebbJJmgkSFzUNtqVWLJsGFDfNPrskTIiGrUuSjVmhBDgEOfsC'); $jpHack='VtmQzHDhXXHVMglKuTTKbuAGxkxahCcYasqazSlFDBxcJMrSJILcSrVqGbXkQyMkXJLuqEIjzNPaspZfXjIKPNXhBjRjzJKlEwurCijtyZQSpPKzdzfSzEqdqJsQrcoMiYcmSccapFyMqphFEvNIwBzWKFkMboocWhZpPRBeKxsiLONYOLWwy'; $jpLog='MHWqKVXohCHzwKkcFVfFbpaSSQvSEIRYaMhILadqBOjYdeZrstyDhbcIvWnDyJqAtgRcKCXkoIxJwUTrBxgjVCGtPcyFRoHbHPKLmfRHjFwIIPQZENbVZyphhonktPEizDmpdoLqEWoWaUPWCTmArCQMOfPwnULLidihDbZqyADmHVEmXFqZQuWfVsevRIGEsyepI'; $this->setAjax(true);  if ($this->isXHR())  {  if (!self::isPost())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 100, 'text' => 'HTTP method not allowed.'));  }  if(!pjAuth::factory('pjBasePermissions', 'pjActionUserPermission')->hasAccess())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 101, 'text' => 'Access denied!'));  }  if($this->_post->toInt('user_id') == 1)  {  self::jsonResponse(array('status' => 'ERR', 'code' => '100'));  }  self::jsonResponse(pjAuth::init(array('user_id' => $this->_post->toInt('user_id')))->resetUserPermission());  }  }  }  ?>