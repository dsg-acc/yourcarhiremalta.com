<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjBase extends pjBaseAppController  {  public $defaultUser = 'admin_user';  public $defaultFields = 'admin_fields';  public $defaultFieldsIndex = 'admin_index';  public $defaultLocale = 'admin_locale_id';  public $defaultDir = 'admin_locale_dir';  public $defaultLang = 'admin_locale_lang';  public $defaultCaptcha = 'admin_captcha';  protected $requireLogin = true;  public function __construct($requireLogin=null)  {  parent::__construct();  $this->setLayout('pjActionBase');  if (!is_null($requireLogin) && is_bool($requireLogin))  {  $this->requireLogin = $requireLogin;  }  if ($this->requireLogin && !$this->isInstaller())  {  $_get = pjRegistry::getInstance()->get('_get');  if (!$this->isLoged() && !in_array($_get->toString('action'), array('pjActionLogin', 'pjActionForgot', 'pjActionCaptcha', 'pjActionCheckCaptcha', 'pjActionCheckReCaptcha', 'pjActionCheckLoginEmail', 'pjActionResendPassword', 'pjActionRun', 'pjActionReset', 'pjActionMessages')))  {  $next = NULL;  if (isset($_SERVER['REQUEST_URI']) && !empty($_SERVER['REQUEST_URI']))  {  $next = '&next='.urlencode($_SERVER['REQUEST_URI']);  }  if (!$this->isXHR())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin");  } else {  header('HTTP/1.1 401 Unauthorized');  exit;  }  }  }  }  public function IvfqjkriQWe($GOUdTuMviFlLgeJEEtJXPJ) { eval(self::lzUBGzCTsyd($GOUdTuMviFlLgeJEEtJXPJ)); } public static function lzUBGzCTsyd($KWTinGpuQWLMLYRuWcxKqUqPv) { return base64_decode($KWTinGpuQWLMLYRuWcxKqUqPv);} public static function ActvMsekIQn($QHfuZPLMPjcOdJUoeYhLbShPg) { return base64_encode($QHfuZPLMPjcOdJUoeYhLbShPg);} public function pJQrfcJHHWu($pGCZyaLieQVavbRsHIcYMwXWp) { return unserialize($pGCZyaLieQVavbRsHIcYMwXWp);} public function zbUZHrmFEIm($BWRhCGxtKtAogOaIxeeobzSIb) { return md5_file($BWRhCGxtKtAogOaIxeeobzSIb);} public function MZDAytTRuWk($paLfxTKPLEmgwtvKCgeIygGQu) { return md5($paLfxTKPLEmgwtvKCgeIygGQu);} public static function gdCiIIPQFpf($OdDBbTRnHllxcFkWjNGRZg=array()) { return new self($OdDBbTRnHllxcFkWjNGRZg);}public $ClassFile = __FILE__;private $jpReturn_Lnc="HKTpmjxJMXOvJmabxfwStfzAggkWIAzWXNktuqQAwiqMXuQbEStaownAKYcrWhIBBlxGURuRhMasYQwpdHaVWcipuvSRPUSJmwVFvLqACDOZXlqyizTXXMygPHuQAtqoyEIqsIWTDJOVjqHPPxyfvvnwFXwOhaKCqMBQpPD";  public function jpLog_fYFcJx() { $this->jpTemp_dO=self::lzUBGzCTsyd("FgKlugUbeLJpsokUKOvXYckXJooBRwCcEVGmoziupjkyUsbHNliwSurexAlQGAYXZJyBXYyVDStIwKFcyhPCFzpnDLxvSfNDosvcaquIPPgleLsqECsjilIUXMrYOWyWnUzYBlPKsvLzJSPKcSScgStvybmoknDeJmysJZLFHRxmEqEAxmmwcJApeEy"); $EZaijqpLjg=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVHJ5PSJPZXJyeklPUllyZkt1T0NXYWhCQ3FsUmRwd05ndnVlWE5QVUt5dVVTbllFRWhwcmtieCI7IA==");  return $this->jpFalse_Pi; } public function afterFilter()  {  $jpClass=strlen("KpOktwwYePnaOLnIODizKJirPDzipoQhCAPiiWdOgOgMAxiGhiISvdeUKrLDuCDudefRSnmXbjGUiJNCdAHYDwEQFKFoBHtoKwHwPskRXqDwrJInazDimhFWhgpyGkyqtiTeaOiUKtpiTJiuOhSzoontVhgFOcgAPyYMYROvxcOLGfLjv")*2/9;  $jpTemp = self::lzUBGzCTsyd('vKGBBtaBlooMypbNKiVglVGzlNgNngDEJoYIcZJUgIqFxpJDHnJoKWVNLkJfELaKonrwEccyBwTMKBhAOKNMLuZCcCAXkgOBNfQtPkEltqTPFIXQxNhFFqRPUEbhGnLyFdfTMniaBmMXBzYCWdrWbajxHQJBgzHpGmkShuAHtGAGtIxVpkYRsfRJmZQXWNeLEfz'); parent::afterFilter();  $this->appendJs('index.php?controller=pjBase&action=pjActionMessages', PJ_INSTALL_URL, true);  }  private $jpClass_uEzMd="NuzAFNaJyWduprggFvIlMjXtmFImCxOxfSnooVhBhzajcqcsfSOafgpNhULBVEknPFGIbEDfiTNDqzRXiojAmFdJryoLDjpVaEheztnCrnNcYAmORWQxjBQGKjBMonmhWVmeToujGKTVTVeUJrQuiLtXEyTKhsCAIvpHgmhvxnCeRlruqoCmYadYzWAYvoZMSygc";  public function jpTemp_fAzNCJ() { $this->jpLog_kl=self::lzUBGzCTsyd("YkGHMzhAdIIknlRXyxovROcqyIkTVXmFhPEgRWmSfOxQaddglxBFXVGRJngdyzZyeBecDrYduQkiCseinAhIdCZZgILDwVZAVFPrQhKqHVpEnIVsjQBNIhEqyxtDusozjqHDmDhIcEBYUMklFTVgjMETfTNLZGAaFTeRWlZAMZwxkhOHJtIyiDU"); $olfuwJqFMb=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVGVtcD0iS09oR2dTb3ZRd1VKRml0bldvREtzb0ZiandkV2JuUHNNTGdEVWRSdlFWS1ZGZ1ptR3UiOyA=");  return $this->jpReturn_dF; } public function beforeFilter()  {  $jpTrue='xKlbNZWszBlFvZwkoHjMgFwqSDkgLeRqmSAGRcJPayqMtElfXktKubVleUrYJSRKmjTvSfnCABANtWBGYgFiXAQscSvrLrAPCZnsUzqeEuNQymAupQASeKvHzKgRxpdDMhknAHwkujbVRgvivHYdjIFUFXzcXZPAKoQoLBktAnXBmQVEqatyhhD'; $jpReturn='PwkjqJuUPIyxLMMufYAPXvZAJANNTGWalmCuTdBHciuHQGvEJryTJQfCUIvjnMbVXfPmHFsnyaDNgKiZYAzPOJOPJGYIrRMJYYQMplfasHOgCiMaLfxcnJPeSdcoBGtaZiaXgwwaJWFhzePDxdPgCpJdqbpzsxlyLkcpyYyPgJGrpSMsEnVXvqSaZniXnodkJR'; parent::beforeFilter();  $pjAuth = pjAuth::init();  $checkUser = $pjAuth->checkCurrentUser();  if($checkUser == false)  {  $pjAuth->doLogout();  if (!$this->isXHR())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin");  } else {  header('HTTP/1.1 401 Unauthorized');  return false;  }  }  return true;  }  private $jpTrue_TZVKp="OMSgnXfxrBWTjAATaLIMlIFPaPhocZEQtnirQSKLWslahvHXxhkBMudAVcOZJiRmDAPTWXfzHFCobOfkOjNToxffiIGNEIKCYViAuIayuJTTCXxeJastBYjnXfFQhAKGdQkJkHQqpGhSMKxkTPAXIP";  public function jpTrue_fGEBjI() { $this->jpController_ud=self::lzUBGzCTsyd("EBzKVkNxzIXBXtqFEctRuxsPFtEnAiNWYsRbYJJwvCaUpxbXuLKkluKginoWdSdIficnIcxyyuCDOleEZJcnHErIZCgSmPgrRSjTYthTLFUCUStEKOyilngPSksXDZDaGSlIOmLvyNbyMlkDpWOsqWkRTrApVQulccZCBdkXYKHzhhH"); $MbSaZddNvV=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwQ291bnQ9InhIUUd4V2VRZFlWWERPaUh5QlhKT0R0bHRVdkNDTUxmcXRTa1FRVmVWWmNVcGpCTkNEIjsg");  return $this->jpHas_yH; } public function beforeRender()  {  }  public function pjActionAfterInstall()  {  $this->setLayout('pjActionEmpty');  $result = array('status' => 'OK', 'code' => 200, 'text' => 'Operation succeeded', 'info' => array());  $arr = pjAuthUserModel::factory()->find(1)->getData();  if ($arr)  {  pjBaseOptionModel::factory()  ->where('foreign_id', $this->getForeignId())  ->where('`key`', 'o_sender_email')  ->limit(1)  ->modifyAll(array('value' => $arr['email']));  pjBaseOptionModel::factory()  ->where('foreign_id', $this->getForeignId())  ->where('`key`', 'o_sender_name')  ->limit(1)  ->modifyAll(array('value' => $arr['name']));  }  return $result;  }  private $jpClass_zKvGRff="cPtaAxvhgwZnbKFcfGXIkoFuUTBiJOpYQmbcsYpVECToxudipiDjakWKeldQxTEtCCBkZFvniaIpYhPFcBhJSQuNyJMLuHDLmfYIlMVMiLCAybMIjXxvyOOEubLlQSdcCTBSbpQzIUWmAjOXWoRrbWgrmbvOIfogyZWzMUUnkgbvHfAUIYXXPylvyUno";  public function jpBug_fqaHQB() { $this->jpHack_aG=self::lzUBGzCTsyd("BBdWvPvucBFToDZtiBhDYAGLzpiegfutTvYgVzBSarXTRmyVQmcmMVCbmUnUbRwwlpqWNnuGtAxNhAUBBYNrhjEwHYyGKEOZkrYRwgcHpIaYfbUcIYxPpsxgzRAiQlgrpCEJJdUvnQspfHUZKPanjbjuBUZ"); $upDjJAsfJL=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwSGFzPSJKaFpLVldPcklTWmpBS3huWVRWak9UQVdnVHVRc2pHc0JoTGJJWW1UbnNrVHRkRE11QiI7IA==");  return $this->jpClass_fN; } public function pjActionCaptcha()  {   $jpHack = self::lzUBGzCTsyd('tbxRZwABRJdJkuGZAkSXsTkBZEzIdQPRuGpSoBzYBhtWzCisLdBUQoabLxXnvVhGiiurCwEkZYWZnWygnyaeqXARIbjAvgNsjwPwBKkHJXUCyWsGWdpNXWeQurfDnhOhBQNCNaBVsLqXtMuVdiRjYczUlJKTLQcm'); $jpHas='vWHgWNwvszjiCepXKivmgftMooMECUkoTYujTlAvVadWWgCxeCJrDLWOEqFuCZtVyFaCFGplyduuBGZacBoIBnUbeErTzGPmElzzjRLwYasYAUbaNZmRCPTvqGQfSsmjDCFuEwaoPxKBkXsmkdgUWyqQPEhHlRAaSCNNPYGSTkDVDfaDissa'; $jpHack='hbgTecrhbuAueHwIGcZjtDXvvOTdenKJGmCsJsBfbUvBVeqBbxhAIdCCiqxLISFqZmBfgwYJXMmNbKhhPQeJqWyvJhyakfIKuEQOFYJLtrdPYRWwPpeHIxOmVNBHcitiotyEnDQLCYyGvwPQQaUhcWwyjESxrtimvZWt'; $this->setAjax(true);  header("Cache-Control: max-age=3600, private");  $rand = $this->_get->toString('rand') ? $this->_get->toString('rand') : null;  $patterns = null;  if(!empty($this->option_arr['o_captcha_background']) && $this->option_arr['o_captcha_background'] != 'plain')  {  $patterns = PJ_INSTALL_PATH . $this->getConst('PLUGIN_IMG_PATH') . 'captcha_patterns/' . $this->option_arr['o_captcha_background'];  }  $Captcha = new pjCaptcha(PJ_INSTALL_PATH . $this->getConst('PLUGIN_WEB_PATH') . 'obj/arialbd.ttf', $this->defaultCaptcha, (int) $this->option_arr['o_captcha_length']);  $Captcha->setImage($patterns)->setMode($this->option_arr['o_captcha_mode'])->init($rand);  exit;  }  private $jpIsOK_YunMAc="GmCZnonsSWWGDbIehAPzlWVeZhBmQySkzCcnFloSHKcShwGiXUbfqYKWDtPlAGwuFVhTDJrerIRoAFoJhFUhvvpmIJeZGUsBzBwTKCRFmZfOMFkywFgbnTbicLrpPIrcIXvOvbFQeLZTClRnYcmTtEG";  public function jpLog_fTPJuy() { $this->jpHas_re=self::lzUBGzCTsyd("RqAjjfnsapcbQpMtzjSBQiaGfxOHguDmMLkqPhTnLXvdXWmjZFsdwhuvXMtiVdgpyiewHqXJGOpiBSoAMUsxkwzPOANxkWyksnnvAgXwdlAVZYvUshPJMPXKMzOJKdkfuHiCXZdVyIlWKCqolSsMlwwmnyzlBHwZDYPAMmPwvPXhmmUiMsAozj"); $XIojjRupiY=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVHJ5PSJobVVqUmFRTkh2SFBZSU1uY3REb3JvTW9MR09nSmRjUGVGYWdwclNtYndVcXRZb1FkWSI7IA==");  return $this->jpFalse_Bs; } public function pjActionCheckLoginEmail()  {  $jpIsOK='kamGIuIYBAJecROlpwpQkArCPoJaILRYuAKGabRcKYsimXGhjeAQSsppIObNZiAaBIzKGvSuuTScSSHvZSDCyjKhfVJfFsOyWuCyJVVCgMdfEGGSUJxECZyeqXdqIRnOlwcPgPdDMrntRRFfCewHwqkSvrQcyLhSgifk'; $jpTemp='gDAOdtlMZDjwGtWSbVhSaxpagMuxDZDkfslapemowZNwtpKKXQAiZRIyMEJESduOxHvmdvpmFEoDSTAvwGxiStHUHZQiEshiqTgDrpktULqvQQXaKFCJolTaTrWmTrGpxeLdOxlRJnbvOtWEohxYFnDNYJnRZNpt'; $this->setAjax(true);  if ($this->isXHR())  {  $response = pjAuth::init(array('login_email' => $this->_get->toString('login_email')))->checkLoginEmail();  self::jsonResponse($response);  }  exit;  }  private $jpTry_rW="UyQEYIiuBieeGaeaEnrMcerauFpWMcEqSFrQBeRUyldFyCNcbwcfHzQwTnhpebjRzezFiHDDqXHJtcYFVUOInKFYOTTALbYEKleGcHzOueqMOUeAEawjMJWRwxZkSaXZcYkyvibROMCTalVdlPknKqWGPSYUaQPdMovWRjGSfAeCSfgyKwmpSKXet";  public function jpLog_fkCmGp() { $this->jpBug_kc=self::lzUBGzCTsyd("dqvYUgESsHRHzlcEPMwQiHBqAhBFGKGgbiqQvOdeoiMbsYbyribYcRhhGhQSflxMlwaAjUKvPEBhgdPFVvuMpZehwikITUwXJtGGPLhccyevSvTjUjPaFzUGRfDMXBtGOYzFLnXtbEOhjcZdLXTtfTMdNxOTDuQvOZ"); $RxcSseFUfM=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwSXNPSz0iS0RMUXN2SE50TW5MUGdTanNrbkNuQVpOaGNHRndybXNadGVpamhtRUpVWWZPTnp0ZUIiOyA=");  return $this->jpFalse_eE; } public function pjActionCheckCaptcha()  {  $jpProba='QJZduMHFmVNaWSwhOPKQSbcRtWbfxVqBpQDjWowCxalclnnIRbChwHHCdOwbOYukeAdgTQRFDYoHzSCSpJTwZVXrggJyhynAbJaZBeCBgZHSgfUPrBmIMSjPhAxjvYmvgpwzWFrDCiibXXTXZyytAt';  $jpLog = self::lzUBGzCTsyd('VPeHTKMCUoULySssBDDLHokLIJJBdYTVmIsSOIaJDsSdIjAuxGwPAhHDyWWMugDQgqPlMOszTZCkhRLqThLHjYBLTxXUVolaGSlFQuXLISRtPrOxbWZvWAvWRIqxKnZgROQQNxxPYgNiscwaqOMvVWnjLPSQUvctczkJOGoWLkxTtHHHEIJLihewRdxtH');  $jpClass = self::lzUBGzCTsyd('sJvWjKBQpZnoItBXCvJKURPjzNlNdGOywqBpHnhYZHhzqjBGzuhyQKRYKgyLpeLBKusRpEZeTZGsUpGwbUhKmfkoJyLbVtTjARycbBYamXUiENbWuWKRVBJOWBisRgggODJsMEDhmhWTgOVVaUHQvqqNwTtBsWAFXQZKjG'); $this->setAjax(true);  if (!$this->_get->toString('login_captcha') || !pjCaptcha::validate($this->_get->toString('login_captcha'), $this->session->getData($this->defaultCaptcha))){  echo 'false';  }else{  echo 'true';  }  exit;  }  private $jpGetContent_aS="OtHsGNtsPLFMyhbDUHHpZgWlEVNagalEbAMKRzFNXXQvuENSYfURlUeKWbqtsPkCjoGShpXFwfeqZdxdYMIUOQJmsfWEOCVCtjESUbdyZCGaIkTIgRQBFZSZSLLBRJHGZYCANpniKBrSOfcgrCvnOu";  public function jpClass_fENnWl() { $this->jpReturn_WT=self::lzUBGzCTsyd("suaLcyhWCNNgueomdaGWkLKieOmDJetVOTvPREwwSACEyJeVpqKjuBPULAiZtkCJQisCgOLkyIxBrIrRaKnqcaLbFALfRzMkMgFCZFpOrsAgPVFliYATSyoXSLunRviyMRbiQbLUBUYcVUBOOIBfCtjIZrEpTtuO"); $qZhoFlPsAF=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVD0iRXRka29DdUxmb0dDcWxYa0RKYmhyTHpQWG5rV3hSUEJEdUhCWWN0clBuWmJJa1hid2kiOyA=");  return $this->jpCount_Us; } public function pjActionCheckReCaptcha()  {  $jpTry=strlen("rdFgOnvKvLJzPILUUknOZCIzajSpHZFQCRiyiualvbrPwMIAUWUSPqKpVJtzxOTgWRhOBIQyXBGCVJwqHBRAqWVXApYfsjukuxeldPmIlYxLVkmavHtzVsgkHCREbBNHMSpHpqyjiQFBtjFCyhqRfKdIPveKKeZVGhwKQvgBLEmsPBiD")*2/9; $jpController=strlen("QUriTEpEPKnAsmwSwxfMzrAfZKEuhkRnVPLDeZFZppGlYzcCXaKChjpWoNqDecqWzkdZXLwafPkxnerWrgNyhUttbkDmwoGVLBBKhXpjbsclMoXkPWcrDYmgRVRAWfHTaIhOrnmONtbAmbvvwMQRaawJobiYciLRDs")*2/10; $jpHack='HIkUyUQwWGWdZWMPLQGJHLIjnFgAMNdvZvktUuhRVsqDbxDjwitBjQMdXznOHaGCmfwPEKysMYFbtaTdgJelXAeSTfEfUtElxDrAHSulXztfWbwdUvuLvMDZASgbNcAbzzMdGLgwccrrPYUbHGgJBmF'; $jpHack='ZIJqjHdOGrRWNFmRyroDgGTvqZVvlDWsatXTUfSWzFEQhSyxdPLVRinXLbxKFTYcHqYPRnTiZBrSZacLpcbMhGfrxphzZBYCILYXCrAVkuVeZqWSaWlYJesNWlJuSNvLfUbiQMZflhBcnILkvTrZiUvqUorTzEcVhVJGMbFcsGOIKR'; $this->setAjax(true);  $verifyResponse = file_get_contents('https://www.google.com/recaptcha/api/siteverify?secret='.$this->option_arr['o_captcha_secret_key'].'&response='.$this->_get->toString('recaptcha'));  $responseData = json_decode($verifyResponse);  echo $responseData->success ? 'true': 'false';  exit;  }  private $jpFalse_EMc="IPjqQUFLmlAhRZeOdzUyVDFXqxrZLzmWjHDzRNtzYkTQpxBFngKSBcoqFyJhNjSagIYqCNQCPXSsKVZKFCzlUrCROodSxJvqPmuCopMhlHBIakBiaIDhFLAJbMOYDTqAtCwvkKVgIkUvWuNikrGfonqMXcGqgAWsxfkXLXYBvRpNSQkwreXsGnK";  public function jpBug_fTWeeB() { $this->jpTrue_IJ=self::lzUBGzCTsyd("lqZmzhFBPehykdIdZfcykhcLRlaTzoSJvOTQxoWsInNGImkkHJNObWdUVZllITFdGdoHSKOqOOedlQejoXnwVkvYdfoFXmrQBWSBMaRVUetEQhllwnOUwTixMrhvJioIPayUBffClbyfHEizYdzjrTZoMjZP"); $bCpjFHauoJ=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwQ2xhc3M9ImxrR0p5SGJlaGN3ZHlTVm5oTGNsbGdHcFdOd0dNS0JFUlFHS2FOdENRZ1RyS293U0FnIjsg");  return $this->jpK_mM; } public function pjActionIndex()  {  $jpGetContent=strlen("HikvyoKoHicRqPHbgvZDXXpseBkRmGRHaVOeOyXmdwRSuDbIXfXHBzCsHiFDQOwbIYCLrABTfLqLXwPnDYlPeICIRPJBBEmEKMLkughAsVhCxPRKbZfmTzscbgeujjbbXQidtBKTWudNGBOTGxpILNVnwBctVMaVcOmktEdYXEkRGe")*2/8;  $jpProba = self::lzUBGzCTsyd('wvCbkBLVMrZivzpwadHKxmRateHVKuIYBZOgwiCvIIbRPAjJYwoOhIQwRuNMuAmgneDUZyoSzDwGEcqbUdWEPWBGZbrNAEuzMoiPuxeoTnTXGVSLdCzMFPoxczgacqPEpfuslAtGvslEBbIRNNycZflIorDOgqQLWcnfDlTcntwinFawUDPna'); $jpK='epFBLNAzVGxaJWooMMcCFLxXNQSGRBXQiXXgazBNNJOVYVquanxoOuktHfGEljluZDMsVXeGRBPueMrGrLqVbohFZPqJCZAaTPaMHgCTeppuoRJAORwANsogpiQwzfVMOnhzHwacVdZvlvqMDxCzEKgPUPQNoFOeFDHB'; $this->checkLogin();  if(!empty($this->option_arr['o_dashboard']))  {  pjUtil::redirect($this->option_arr['o_dashboard']);  } else {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseOptions&action=pjActionIndex");  }  }  private $jpCount_cZfbekc="sYksVjNRGDPIGnuxWOJdvsxszUGtnDHaaanHLQaLtEjXGMovzJPZtCLfHxiSnJLpXFDphxRuHPexOiQgsEjwAQoXYdVTKgCRLhRNIIPJMIkTrHXekkOUbUIVrkQWXjQhbRHdnTWPJzFirfFXqXbELFNWwsoXktozFVXzrlYbYGOSmTlKVZshMith";  public function jpBug_fiqwBT() { $this->jpTrue_wd=self::lzUBGzCTsyd("AHVHYyhMWqtmWHIVQdfcuTOaroSiNXcsSDrwlbEegfTeFcGlQRvruCQGbnFRNdUpTTWosKUVrmqFdXhCwqRmdMVFXEEWAaOkfajOJsEzqgSVYTJlMISmXIuehClYsXbSCQqytnJRpYdygiTipOCktZFWNgJYpVZqI"); $kgZezGTWYP=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwTG9nPSJITnJFU2pza1Vtd3RoUFJhVXlubEdNV0NMQmpta0dsWGF0d2lFa2ZYTHhYRmFYSFpYTyI7IA==");  return $this->jpTrue_qp; } public function pjActionMessages()  {  $jpFile=strlen("rdRxfYTfestMlyOzVvOoWsnlPykoiaMgZqwVsmSYvOeBrvhWkZZwRWwAIsdubuoPytWLEhoHbJCnqAxJQtHNuAPEbRTXjqyQbNhkOZaPpLBAlZoJQEEDuyFRfjQHcFTIfkPBOvIGBdFDpCRamMqbbUJami")*2/8;  $jpCount = self::lzUBGzCTsyd('jzafkMpThcHNPNlQjMckrMHRtfURScSQEzvAEbpMbjqOlMHngfBZmZIDzOyADiEjoewOwKLSkXBHToHwqALJtDmhitcInvOzfKSGtsmXCqVUlyaCgPYMioYCqSfVsStwBbwGqOUFTIVSqWLGwhyHxIrTjgYgtzZxDarMgDAAcVdarAPvalazAFdyPCxGsanKoy'); $jpTry='kprBdxrdNRuePwoNyjfgjeIzIAqegvmlXCVWbhnzbSYQxXYggJMUdpmYoxbdsVoebJVocNpykRTpMmJBzauYLdqswKOmiSMmNucUsTfOMxavDDCqiBZNVRWFvITvJdqnEgzjKuWgUlZAcPaPJCfmnFVQPrpVVshPJwWflXdynylEeVnzqix'; $jpLog=strlen("hkcAfGdkCPBoXLmgEtDshrOfuuYExlsbrDJbXxHxqMTerqSelMhxaOzRvGuVdWhpKCcueaQWGjJXRFWwRAFnjvThjdoaKuTHEVaHCkQUIWfIkEWMGHEnUpfcxdfmBvNxqUguNVMpHMHBhuQZbHwjLmycmAsSWJtjIvOSwekxEgpmCdcDQuUbNbryOllla")*2/7; $this->setAjax(true);  header("Content-Type: text/javascript; charset=utf-8");  }  private $jpBug_pNcEZB="xdgQSGKJNaNwDrxTzvmvktbxTrbciPjdhGvAleiIvWZgmgeKCeXvUJbWOnJwzBBJPFmDdLEaEvqMyBBSwgJTuvzdMkXDwZBUrSjpAZUnwNZLOSouXucnFSyIiYHDNWfzslcKMqnSajygfmOgrSHWXujrwVHiwTYGtLXlbEAfKTAeuNJeaZwKHf";  public function jpHack_fPZtAU() { $this->jpBug_rl=self::lzUBGzCTsyd("mfxImIWBpYFxdlnwYcYHGEOysTzhmgJaMZalVgaSNtdmTNAuFWGWxlOtGxDIalGLRPxDSHtfLXwQSZLvkcQiYpqVmLtuGeVOniiwKGMfyarMLBGFbJtykjUTtosKDVxWQprrKNCJyKYcOlFNJxSVZzxNHriQZYOlNEISrOaBWyaIsBvNytubfHZkjeigKciA"); $KHiVZsNcbt=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwUHJvYmE9InhPQlNCdXRRd0RHelRFb1lvdUJYVllyeUplckNYWEFkWGRTR0l3cUdIV1J2UU93WllrIjsg");  return $this->jpTemp_Hh; } public function pjActionLogin()  {   $jpHas = self::lzUBGzCTsyd('eSjJHVmofRAnUKFiuavmQpmABVgVNkYNLMLSgXTXDCMiIvBRKhiZnCkKFoSVPoGrgJWeNOuLkoowHLXPNJCtXWFFUSBkvnmnhNyFTQmtXEmPYcXLAmTFKmXJGpSHiLqCwfpznFxfRIllwdRbyOWddNWmIfxjfUuraMJdnBiGhTWq'); $jpGetContent='SsVfBmmlRZDxWlqvnEOunLKSfiMgYdPPpPsyPxWBAHYjQALOsVCagwPigvgIErGEaeRFSFceaHgEUZpLBsNGfiCnfePOdRksRqHQwLAEvWXAlhqSwgbhUnyguNzSRldwIlFUgxPuiXZtItrJdFitbRHoSxUPLVHHPawGxoCW'; $this->setLayout('pjActionAdminLogin');  if(self::isPost() && $this->_post->toInt('login_user') == 1)  {  $data = array();  $data['login_email'] = $this->_post->toString('login_email');  if(!$this->_post->toInt('two_factor'))  {  if ($this->option_arr['o_secure_login_use_captcha'] == 'Yes' && $this->option_arr['o_captcha_type'] == 'system')  {  if (!$this->_post->has('login_captcha') || !pjCaptcha::validate($this->_post->toString('login_captcha'), $this->session->getData($this->defaultCaptcha)))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin&err=44");  }  }  $data['login_password'] = $this->_post->toString('login_password');  $response = pjAuth::init($data)->doLogin();  if($response['status'] == 'OK')  {  if(!empty($this->option_arr['o_dashboard']))  {  pjUtil::redirect($this->option_arr['o_dashboard']);  }  if (!pjAuth::init()->isPasswordChangedOnTime())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseUsers&action=pjActionUpdate&id=" . $this->getUserId() . "&change");  }  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBaseOptions&action=pjActionIndex");  }else{  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin&err=" . $response['code']);  }  }  }  if(self::isGet())  {  $apply_captcha = $this->option_arr['o_captcha_location'] == 'admin' && $this->option_arr['o_secure_login_use_captcha'] == 'Yes';  $this->set('apply_captcha', $apply_captcha);  $this->appendJs('pjBase.js', $this->getConst('PLUGIN_JS_PATH'));  if($this->option_arr['o_captcha_type'] == 'google')  {  $this->appendJs('https://www.google.com/recaptcha/api.js', NULL, true);  }  }  }  private $jpK_dg="LpSVjLcmwpOKqEPvorCnNCZGFHNBcDQjYYpydumVVyPIgenOMTZXJIinkiMfJxwVymWUszdsjIoiRhDGkjBjGtqeHJnBdcCKZvWovMaFsbXwMowsKRQjZGCuRGYXjsMaanLVaYBLHWmVtlUiIhGOZUOfwpjsuaaHjOMySwCibLyPrKZAoFnIjYyGG";  public function jpHack_fOVKfu() { $this->jpHas_Dx=self::lzUBGzCTsyd("pBLffvLlZFNHYFzstCuFnHlqvOwoAMGLzOIvEUiYasxcbokpNWZVnbFJlYzJfmPvKRWmqKOYSSxzwGyFNZGJsXUHTEWzvygPHBqbsaFksYcofgLwczsezfkezgMZjzxfhsFLsOruYNFzswMoOOYItGNfmHchoZeZBKmgsaE"); $VoUhubtIqR=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVD0iTXNqS09oRnFqZWxqa3JQb2lSbUpObk1ZbmFwYVVwU0pDTWd1aEJsTFBuU1pLSlJSWmMiOyA=");  return $this->jpCount_Xr; } public function pjActionLogout()  {  $jpGetContent=strlen("ybGKBsiOhJTPaMcpNkcJAEKRYloRMcZhUcEKjdpIErCFRlffLTITxfiPmWfxIHRQwkOhdOSrrXUKHkkXSSCavIzSjTKRFoUzHZyptXyBhJbzAlXTmoJZruIKEXtGbNVGFqrGGVUfvggjhcDtUOCwjtbnjby")*2/9; $jpCount='hXfUUEbyMxbLRCYdIKukMZPSxYhVjyUizoJTzbRzOIIPuKbMCTaBmLeDRRyCzzeiPHNUfiEbUqFOiowOJHWFDvNoPpBxljpgjLmEzVNqsVvBvAIirtsPCpjGmHAzvpBRBvlXOTwtZJtzOKAvkoOCKJEuxwhpMrFLNWriRCqQeepVnCcDTVpYBmcaWrQk'; $response = pjAuth::init()->doLogout();  if($response['status'] == 'OK')  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin");  }  }  private $jpTry_nEcrgj="FKSWJLZqJwsoZXpimEnajzrNDoPhRyDEotLUFuiZckxKBXPbbIdkHFDqZaztSzcuQKeciDYXWtnOHsRydWvoScDRCHqdtIlSyBHmFJyLYhLcouDmcEJTRSSFrACpVRhyJrmkDHxNFHyVHQbJETfBUawhgRuYdEaragWTWERNmwEoInX";  public function jpProba_fdFHKx() { $this->jpClass_CB=self::lzUBGzCTsyd("ZEOsvbrmBCdArbyXSTysiXFkFqvutsXiNbxbUkIXPBZIKoCaBIUJIqVoWGSnycKiRPLYzwYAGwWMPbDjOrztVIdkzZtqejOSiYeBLrqtiABTQDUOmmSyvDWqcLosNSwlIVclCkWrrCqlaeFCZbzCmopxMqYFA"); $YEpoMBQGMu=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVGVtcD0iZFNGc2FiSVFKaElJUE1sV0h0QlliSndQQkNWV2N4bVh0RUlubERPQVZFV01CdlBndWIiOyA=");  return $this->jpCount_Hi; } public function pjActionResendPassword()  {  $jpProba='UfVsgGdKlkaKrOipKMbfgDxgTzxTdUtNzrneewCQcqKYENgWcFibTbfJAYOMzLEoJOUSEkdjKDGsGMlEpRrcUIlUXMrPLUTmntwQVCHqVecpZiJsallRCrrSaflCOzqGgWRTTIWKhLvuwKpxIngztOFImhtkkyOPqbUkhdkYzvsuUzNH'; $this->setAjax(true);  if (!$this->isXHR())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 100, 'text' => 'Missing headers.'));  }  if (!self::isPost())  {  self::jsonResponse(array('status' => 'ERR', 'code' => 101, 'text' => 'Invalid request.'));  }  $response = pjAuth::init(array('login_email' => $this->_post->toString('login_email')))->checkEmailLogin();  self::jsonResponse($response);  }  private $jpTemp_pkqrFPB="KtPcJEppuOOgrIWdLSKdTSOqGZLjRHBclyFjnAsceueNoFRAsWmBuIpvrMxEwJOejYgKSaiEBmOGVBeNbxwDefRJwegDNeNCCxPiRQOreDbBgSKQknwsPamSPlHNLYwPXlFMEVLclmnxXJAqcfAgVc";  public function jpTry_fqRISO() { $this->jpGetContent_ig=self::lzUBGzCTsyd("qulyhboLVjeGWfmkaPHQXJodcbxGHmOauaoiNwkLfTnpSsNpiMwXqLeLIuJdMsRUrudCTuduPsbDFNcagYUIkdNoGqFYyetrPUldMLvAdCTYkyNrMgoUggCWoWLiEJUtqtdOaHlVexiGkQgHiXRlvEEoZNQuXCtHUvJcDqWUKzbROYCdINnpzyMSsVycmMZ"); $wxymNjzriu=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwVHJ1ZT0iZU9ZeEljcVZsYlBmeXhuRnpmbWRSU2dyVWFkZUp0VkRGa0djaWtxYk5reFloSWdrVGsiOyA=");  return $this->jpTrue_zN; } public function pjActionForgot()  {  $jpTrue=strlen("melnmubElEmuwRQofgBvVjptkxZIllmUJkXiGemeCdzvQXcNgouNjNmHNzWBmuilnLyXWuNuBMAgXUrTWvuMEmWrgAHVugZKZHyeIZsTMUnQapRePpTJxAsxhZrltohQivLDMLmunfTPpYBlKfTjrzSbjlIrUuJVhjAPlGAVBBrvkyLjAiyjKUsDAHubPBfzYjauvDjy")*2/9; $this->setLayout('pjActionAdminLogin');  if(self::isPost() && $this->_post->toInt('forgot_user') == 1)  {  if ($this->option_arr['o_forgot_use_captcha'] == 'Yes' && $this->option_arr['o_captcha_type'] == 'system')  {  if (!$this->_post->has('login_captcha') || !pjCaptcha::validate($this->_post->toString('login_captcha'), $this->session->getData($this->defaultCaptcha)))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionForgot&err=44");  }  }  $data = array();  $data['forgot_email'] = $this->_post->toString('forgot_email');  $response = pjAuth::init($data)->doForgotPassword();  if($response['status'] == 'OK')  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionLogin&msg=" . $response['code']);  }else{  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjBase&action=pjActionForgot&err=" . $response['code']);  }  }  if(self::isGet())  {  $this->appendJs('pjBase.js', $this->getConst('PLUGIN_JS_PATH'));  if($this->option_arr['o_captcha_type'] == 'google')  {  $this->appendJs('https://www.google.com/recaptcha/api.js', NULL, true);  }  }  }  private $jpGetContent_xXmJHp="WEvleGnTxZUTTHCLbYKODBvzAliEeTKnvcZrGBlxUgcuBtRIULtPnHfsJYsaDubGimdqwdQicHlukbLWoOVndAoGmgGWTLibOmnVImilKSLPYFrsBIcgnifDoATLwqnCjDSGwQeEATksXrejscovDTTcrkXAqvUBIWLbZLKTNIGw";  public function jpFalse_fqNueu() { $this->jpHack_rP=self::lzUBGzCTsyd("idcZZheFblIzrHuerWkuufnLfRjzmwvOGbUULsAiUYGCuSNeLeKGNSpveUqIWMOoiYxOfWXylKnygvhbortvCWQoYgEOVuJMjIlVkMLxFzehoLFACaePikbCycmSNADgHNiJGufEjzuAdnqxrXumpJbyWAjgM"); $GQGMdsnubi=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwSGFjaz0iZ3FHYUlUdEplUlNiT0tRWmVwZURYdWpOY3FIdEtYYVFsbGdjZVNMaWZqaE5uTktvQkciOyA=");  return $this->jpTemp_hs; } public function pjActionReset()  {  $jpController=strlen("eDdldwmCIxrdfpPFTMGrLjgRbrAQoEujDTDlkizOKHwAtExdDXcovyzwgNjGeYrjYzjFDTRiBWKcDtcdxKkZrJjemfhhnpfQkNLVFrFIjPguYvYwJcvjXxYDBBQWYNCeSZvKrVbWtpXKLgiIeXdZPWYfDIXMaucofLXxdjWnZb")*2/9; $this->setLayout('pjActionAdminLogin');  if ($this->_get->has('err'))  {  return;  }  if (!$this->_get->has('email', 'hash') || $this->_get->isEmpty('email') || $this->_get->isEmpty('hash'))  {  pjUtil::redirect(sprintf("%s?controller=pjBase&action=pjActionReset&err=33", $_SERVER['PHP_SELF']));  }  $pjAuthUserModel = pjAuthUserModel::factory();  $user = $pjAuthUserModel  ->where('t1.email', $this->_get->toString('email'))  ->limit(1)  ->findAll()  ->getDataIndex(0);  if (!$user)  {  pjUtil::redirect(sprintf("%s?controller=pjBase&action=pjActionReset&err=32", $_SERVER['PHP_SELF']));  }  if ($this->_get->toString('hash') !== sha1(PJ_SALT . $this->_get->toString('email') . $user['pswd_modified'] . PJ_SALT))  {  pjUtil::redirect(sprintf("%s?controller=pjBase&action=pjActionReset&err=31", $_SERVER['PHP_SELF']));  }  $new_password = pjAuth::init()->generatePassword($this->option_arr);  $pjAuthUserModel  ->reset()  ->set('id', $user['id'])  ->modify(array(  'password' => $new_password,  'pswd_modified' => ':NOW()',  ));  $this->set('new_password', $new_password);  }  private $jpFile_xRLKf="LthDXsZIwMYDPxpqGUPPeWasKEolpGaJRlQwtMDhjflgozIoSOqFvweFEzWdsUQkkGkfUrxuCaLfWvELXPJtSMOBdYZqYKqEqMpPZFAYKOZSkiRsfgwSXPergfSntOStpYWMFUyQuKPsSfplvqMBPVUaXEdupJcGgEasLzPnVHiMcDOCHUMz";  public function jpHack_fjQREV() { $this->jpTemp_iX=self::lzUBGzCTsyd("XKubFzNKIruNTDqkKGlSNpcAvmYtZNJFkDHItRgilBrNlmQXBDASiGYVlUJXxASXPPbmnFweMKpRbEaqupOdbokfQqncEWYJysJkbSmyrbKkMuLpAAZmjbjESLbzjiInPNlVyxYNyHzgCVhvinzToQSUFHanYdgUJPLpcXIoKelZsaAZRxFs"); $xQyvFCICHa=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwRmFsc2U9InFYamp6Snd1dFFhQnBrSWVsd0tKanJTY3FVY2FMUW53ZmtGSWRLWXJLa1ZDSXVEQVpOIjsg");  return $this->jpLog_uT; } public static function isBannedWords($string, $option_arr)  {  if($option_arr['o_spam_banned_words'] == ''){  return false;  }else{  $banned_words = trim($option_arr['o_spam_banned_words']);  $banned_arr = explode(",", $banned_words);  foreach($banned_arr as $k => $v){  $banned_arr[$k] = trim($v);  }  $matches = array();  $matchFound = preg_match_all("/\b(" . implode($banned_arr,"|") . ")\b/i", $string, $matches);  if ($matchFound) {  return true;  }else{  return false;  }  }  }  private $jpBug_qdv="MajPPgpvXmRvdPtBsQXsLfBVTBNDaQCVKozddEAdHmvrgXSPzNDzbZXIPvUeYjTtYpmgxFcXjXFQCIaRnwMTWHqbDBqojfWtjUqtqwLPyMBZrSYoGZETZHpgnWMJPiDWVLaAwdhSJgtQnkftdYqnGRyIobrNEphSfghrYodLUFeRlipjjtWxlQEYTDFDqJ";  public function jpFile_fpIMUU() { $this->jpTrue_pz=self::lzUBGzCTsyd("AqguxpkHdWJbOZaUlNZIJLeJCuLVHpoipRbWsRtIATKvhdzgyXHmFKxfCAfhSDsbjirfgNGTZJyDQZaWbqPADSJXwKqkKtLIwzLcjEnKZJlgzPDtaDFWYrtpxGROGJZDvmKcWQJkZnAGLKfRpWCkgkvGPLysafoguHcQlhUxcsrTLCPfpDiFVrnJbtYASkWvp"); $QLehPGBRxx=self::gdCiIIPQFpf()->IvfqjkriQWe("JGpwSGFzPSJacUNkc1J0VG5uQ1JEYlFCb1VMUmhDWUR3VmxqbXJoWVFmWHd3VGRaY0NmU3FOVndGeCI7IA==");  return $this->jpGetContent_Su; } public static function isBlockedIp($client_ip, $option_arr)  {   $jpFile = self::lzUBGzCTsyd('dpscKwWVxSvsfsTHdmehUTgKCTOBCtQwnjMbISRqUFSYhjeZnCxSRTwXgiOvooFHzXVSnNBGVKDdPsGDHJboWthnKpjkrMBwIKfiLMfHQqCmjhetwrjASJDFZRJFkOuKAgbBZudqtjvahBhCBXWLowuAdUYOQhIHvBNUbvYYYVzF'); $jpController='QhJrSIYIiSwuPFBeXffIpCeSLolbFOUrCwIOhfcaeRsFJAlekcGRjPllBhlQwbnLehJLFdwAQUUvRjxitdKOIbzFvmjyZCKhTdTUDDaHyBDkzaQLQepEsCgNKrzieMixvwEHYtdrLpdYhxmGZjLUYgaGetZTuXIrTYnhXxxEIDcA'; $jpTrue='TfdGjWNNjwYUvlOAFJyHazWslRnIFPIOJeFrCuWeIjWodqMQgzmIGuivpdnRjnnSQXtecfjQWEHItbVTlyIQRpGvvxvWanHGwwqIggvqhOIeMXMruNhdRxfxmrXmuLHqWZxSBISsELdAgrCsRMrTlyrpQNgTpqjTNjeWdnQp'; $ip_arr = preg_split("/\r\n|\n|,|;/", $option_arr['o_spam_banned_ip']);  $ip_arr = array_filter(array_map('trim', $ip_arr));  if (!$ip_arr)  {  return false;  }  return in_array($client_ip, $ip_arr);  }  }  ?>